{% extends 'base.template.html' %}

{% block content %}

<div class="container bg-light">
    <div class="row">
        <div class="col">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel"
                style="width: auto; height: 700px;">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="{{old_values.imageurl}}" class="d-block w-100 mx-auto" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="{{old_values.youtubeurl}}" class="d-block w-100 mx-auto" alt="...">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>
    <div class="row">
        <ul class="list-group">
            <label for="">Title:</label>
            <li class="list-group-item">{{old_values.name}}</li>
            <label for="">Genre:</label>
            <li class="list-group-item">{{old_values.genre}}</li>
            <label for="">Directed by:</label>
            {% if old_values.directors|length > 0 %}
            <li class="list-group-item">{{', '.join(old_values.directors)}}</li>
            {% else %}
            <li class="list-group-item">{{old_values.directors[0]}}</li>
            {% endif %}
            <label for="">Release on:</label>
            <li class="list-group-item">{{old_values.year}}</li>
            <label for="">Main casts:</label>
            <li class="list-group-item">{{', '.join(old_values.maincasts)}}</li>
            <label for="">Synopsis:</label>
            <li class="list-group-item">
                <p>
                    {{old_values.synopsis}}
                </p>
            </li>
        </ul>
        <label for="">Trailer:</label>
        <div class=" container">
            <iframe style="border: 0; width:80%; height: 500px; overflow: auto;"
                class="embed-responsive d-block mb-4 mx-auto" src="{{old_values.youtubeurl}}"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
        </div>
    </div>
    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deletemovieinfo">
        Delete
    </button>
    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#updatemovieinfo">
        Edit
    </button>

    <!-- Modal -->
    <form method="POST">
        <div class="modal fade " id="deletemovieinfo" data-backdrop="static" data-keyboard="false" tabindex="-1"
            aria-labelledby="deletemovieinfoLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deletemovieinfoLabel">Are you sure that you want to delete this
                            movie
                            info?
                        </h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <button href="{{url_for('process_delete_movieinfo',movie_id=old_values._id)}}" type="submit"
                            class="btn btn-danger">Yes</button>
                        <button type="button" class="btn btn-success" data-dismiss="modal">No</button>

                    </div>
                </div>
            </div>
        </div>
    </form>
    <!-- Modal -->
    <div class="modal fade " id="updatemovieinfo" data-backdrop="static" data-keyboard="false" tabindex="-1"
        aria-labelledby="updatemovieinfoLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="updatemovieinfoLabel">Update Movie Info</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form action="{{url_for('process_update_movieinfo_page',movie_id=old_values._id)}}" method="POST"
                    enctype="multipart/form-data">
                    <div class="container modal-body">
                        <div class="row">
                            <div class="col-6">
                                <div class="form-group">
                                    <label for="recipient-name" class="col-form-label">Title: {{ errors.title_is_blank
                                        }}
                                    </label>
                                    <input type="text" value="{{old_values.name}}" class=" form-control {%if
                                        errors.title_is_blank %} is-invalid{%endif%}" id="movie-name" name="name">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Genre: {{ errors.genre_is_blank }}
                                    </label>
                                    <input type="text" value="{{old_values.genre}}" class="form-control  {%if
                                        errors.genre_is_blank %} is-invalid{%endif%}" id="movie-genre" name="genre">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Year: {{ errors.year_is_blank or
                                        errors.year_is_less_than_0 or errors.year_is_string}}
                                    </label>
                                    <input value="{{old_values.year}}" class=" form-control {%if errors.year_is_blank
                                        or errors.year_is_less_than_0 or errors.year_is_string %} is-invalid{%endif%}"
                                        id="movie-year" name="year">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Main Casts: {{
                                        errors.maincasts_is_blank }}
                                    </label>
                                    <input type="text" value="{{', '.join(old_values.maincasts)}}" class="form-control  {%if
                                        errors.maincasts_is_blank %} is-invalid{%endif%}" id="movie-casts"
                                        name="maincasts">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Directed by: {{
                                        errors.directors_is_blank}}
                                    </label>
                                    <input type="text" value={% if old_values.directors|length> 0 %}
                                    " {{', '.join(old_values.directors)}}"
                                    {% else %}
                                    " {{old_values.directors[0]}}"
                                    {% endif %}
                                    class="form-control {%if
                                    errors.directors_is_blank %} is-invalid{%endif%}" id="movie-director"
                                    name="directors">
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Trailer(url): {{
                                        errors.youtubeurl_is_blank}}
                                    </label>
                                    <input type="text" value="{{old_values.youtubeurl}}" class="form-control  {%if
                                        errors.youtubeurl_is_blank %} is-invalid{%endif%}" id="movie-trialer"
                                        name="youtubeurl">
                                </div>
                                <div class="form-group">
                                    <label for="message-text" class="col-form-label">Synopsis: {{
                                        errors.synopsis_is_blank}}
                                    </label>
                                    <textarea type="text" value="{{old_values.synopsis}}" class="form-control {%if
                                        errors.synopsis_is_blank %} is-invalid{%endif%} " style="height: 10rem;"
                                        id="movie-synop" name="synopsis"></textarea>
                                </div>
                                <div> <label for="poster" class="col-form-label">Poster: {{ errors.file_is_blank
                                        }}
                                    </label>
                                </div>
                                <div> <input type="file" name="file" class=" {%if
                                    errors.file_is_blank %} is-invalid{%endif%}">
                                </div>
                                <div> <label for="backdrop" class="col-form-label">Backdrop:{{
                                        errors.backdrop_is_blank}}</label>
                                </div>
                                <div> <input type="file" name="backdrop" class=" {%if
                                    errors.backdrop_is_blank %} is-invalid{%endif%}">
                                </div>

                                <div> <label for="thumbnails" class="col-form-label">Thumbnails: {{
                                        errors.thumbnails_is_blank}}
                                    </label>
                                </div>
                                <div> <input type="file" name="thumbnails" class=" {%if
                                    errors.thumbnails_is_blank %} is-invalid{%endif%}" multiple>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        {%if errors|length > 0 %}
                        <div class="alert alert-danger">
                            Please correct all the errors and resubmit the form.
                        </div>
                        {% endif %}

                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" id="upload-btn">
                            Post
                        </button>
                    </div>


                </form>
            </div>
        </div>
    </div>

</div>

{% endblock %}